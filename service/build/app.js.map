{"version":3,"file":"app.js","names":["express","require","app","cors","quertstring","expressjwt","jwt","auth","Auth","use","get","req","res","result","authAccount","headers","authorization","active","status","send","scope","split","includes","listen","console","log"],"sources":["../src/app.js"],"sourcesContent":["import { Auth } from \"./auth.js\";\r\n\r\nconst express = require(\"express\");\r\nconst app = express();\r\n\r\nconst cors=require(\"cors\");\r\n\r\nvar quertstring = require(\"querystring\");\r\n\r\nvar { expressjwt: jwt } = require(\"express-jwt\");\r\n\r\nconst auth = new Auth();\r\n\r\n\r\n\r\napp.use(cors());\r\n\r\napp.get(\"/api/face\", async (req, res) => {\r\n  var result = await auth.authAccount(req.headers.authorization);\r\n\r\n  if (!result.active) {\r\n    //accesstoken 已经过期\r\n    res.status(200).send(\"accesstoken expired\");\r\n\r\n    return;\r\n  }\r\n\r\n  if (result.scope == \"\") {\r\n    res.status(200).send(\"not authorize\");\r\n    return;\r\n  }\r\n  if (result.scope.split(\" \").includes(\"FACE:call\")) {\r\n    res.status(200).send(\"FACE\");\r\n  } else {\r\n    res.status(200).send(\"not authorize\");\r\n  }\r\n});\r\n\r\napp.get(\"/hello\",(req,res)=>{\r\n  res.status(200).send(\"hello\");\r\n});\r\n\r\napp.get(\"/api/gender\", async (req, res) => {\r\n  var result = await auth.authAccount(req.headers.authorization);\r\n\r\n  if (!result.active) {\r\n    //accesstoken 已经过期\r\n    res.status(200).send(\"accesstoken expired\");\r\n    return;\r\n  }\r\n\r\n  if (result.scope == \"\") {\r\n    res.status(200).send(\"not authorize\");\r\n    return;\r\n  }\r\n\r\n  if (result.scope.split(\" \").includes(\"GENDER:call\")) {\r\n    res.status(200).send(\"GENDER\");\r\n  } else {\r\n    res.status(200).send(\"not authorize\");\r\n  }\r\n});\r\n\r\napp.get(\"/api/object\", async (req, res) => {\r\n  var result = await auth.authAccount(req.headers.authorization);\r\n\r\n  if (!result.active) {\r\n    //accesstoken 已经过期\r\n    res.status(200).send(\"accesstoken expired\");\r\n    return;\r\n  }\r\n\r\n  if (result.scope == \"\") {\r\n    res.status(200).send(\"not authorize\");\r\n    return;\r\n  }\r\n\r\n  if (result.scope.split(\" \").includes(\"OBJECT:call\")) {\r\n    res.status(200).send(\"OBJECT\");\r\n  } else {\r\n    res.status(200).send(\"not authorize\");\r\n  }\r\n});\r\n\r\napp.get(\"/api/action\", async (req, res) => {\r\n  var result = await auth.authAccount(req.headers.authorization);\r\n\r\n  if (!result.active) {\r\n    //accesstoken 已经过期\r\n    res.status(200).send(\"accesstoken expired\");\r\n    return;\r\n  }\r\n\r\n  if (result.scope == \"\") {\r\n    res.status(200).send(\"not authorize\");\r\n    return;\r\n  }\r\n\r\n  if (result.scope.split(\" \").includes(\"ACTION:call\")) {\r\n    res.status(200).send(\"ACTION\");\r\n  } else {\r\n    res.status(200).send(\"not authorize\");\r\n  }\r\n});\r\n\r\napp.listen(3001, () => {\r\n  console.log(\"app listening on port 3001\");\r\n});\r\n"],"mappings":"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"}